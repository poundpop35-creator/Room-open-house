<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>รายชื่อผู้เข้าพัก และรูมเมท</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #0056b3;
            --secondary-color: #f2f6fc;
            --header-group-color: #004494; /* สีหัวตารางกลุ่มหลัก */
            --text-color: #333;
            --border-color: #dde2e7;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #eef2f7;
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1280px; /* ขยายให้กว้างขึ้นรองรับข้อมูลเยอะ */
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 600;
        }

        /* Search Box */
        .search-box {
            margin-bottom: 25px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px;
            padding-left: 45px; /* พื้นที่สำหรับไอคอน */
            font-size: 16px;
            border: 2px solid var(--border-color);
            border-radius: 30px;
            box-sizing: border-box;
            transition: all 0.3s ease;
            font-family: 'Sarabun', sans-serif;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%23999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>') no-repeat 15px center;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(0, 86, 179, 0.1);
        }

        /* Table Styling */
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            white-space: nowrap;
            font-size: 15px;
        }

        th, td {
            text-align: left;
            padding: 14px 12px;
            border: 1px solid var(--border-color);
            vertical-align: middle;
        }

        /* Header Styling */
        thead th {
            color: white;
            font-weight: 600;
            text-align: center;
        }

        /* สีหัวตารางแถวบนสุด (กลุ่ม) */
        thead tr:first-child th {
            background-color: var(--header-group-color);
        }

        /* สีหัวตารางแถวรองลงมา */
        thead tr:nth-child(2) th {
            background-color: var(--primary-color);
        }


        /* Row Styling */
        tbody tr:nth-child(even) {
            background-color: var(--secondary-color);
        }

        tbody tr:hover {
            background-color: #e2e8f0;
        }

        /* คอลัมน์ลำดับ */
        td:first-child {
            text-align: center;
            font-weight: bold;
            color: var(--primary-color);
        }

        .fullname {
            font-weight: 600;
        }
        
        /* เน้นข้อมูลรูมเมทให้สีต่างนิดหน่อย */
        .roommate-cell {
            background-color: #fafafa;
        }

        .room-type-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: 600;
        }
        .type-single { background-color: #cff4fc; color: #055160; }
        .type-twin { background-color: #d1e7dd; color: #0f5132; }

        .no-result {
            text-align: center;
            padding: 40px;
            color: #888;
            font-style: italic;
            display: none;
            background-color: #f9f9f9;
            border-radius: 10px;
            margin-top: 15px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>รายชื่อผู้เข้าพัก และการจัดห้องพัก</h1>

        <div class="search-box">
            <input type="text" id="searchInput" class="search-input" placeholder="ค้นหาชื่อ, หน่วยงาน, โรงแรม หรือเลขห้อง...">
        </div>

        <div class="table-container">
            <table id="guestTable">
                <thead>
                    <tr>
                        <th rowspan="2" width="60">ลำดับ</th>
                        <th colspan="2">ผู้เข้าพักที่ 1 (หลัก)</th>
                        <th colspan="2" style="background-color: #003370;">ผู้เข้าพักที่ 2 (รูมเมท)</th>
                        <th colspan="3" style="background-color: #00224b;">ข้อมูลการเข้าพัก</th>
                    </tr>
                    <tr>
                        <th>ชื่อ-นามสกุล</th>
                        <th>หน่วยงาน</th>
                        <th style="background-color: #004494;">ชื่อ-นามสกุล</th>
                        <th style="background-color: #004494;">หน่วยงาน</th>
                        <th>ประเภท</th>
                        <th>โรงแรม</th>
                        <th>ห้องพัก</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    </tbody>
            </table>
        </div>
        <p id="noResult" class="no-result">ไม่พบข้อมูลที่ค้นหา</p>
    </div>

    <script>
        // ===================================================
        // *** สำคัญ: โครงสร้างข้อมูล JSON ที่ถูกต้อง ***
        // ===================================================
        // เนื่องจาก JSON ห้ามมี Key ซ้ำกันใน object เดียว
        // ผมจึงต้องเปลี่ยนชื่อ Key ของคนที่ 2 โดยเติมเลข _2 ต่อท้ายครับ
        // เช่น "ชื่อ" -> "ชื่อ_1" และ "ชื่อ_2"
        // ===================================================

        const guestData = [
            {
                "ลำดับ": 1,
                // --- ข้อมูลส่วนกลาง ---
                "การพัก": "พักเดี่ยว",
                "โรงแรม": "Grand Richmond",
                "ห้องพัก": "A101",
                // --- คนที่ 1 ---
                "คำนำหน้า_1": "นาย",
                "ชื่อ_1": "สมชาย",
                "นามสกุล_1": "ใจดี",
                "หน่วยงาน_1": "สำนักยาและวัตถุเสพติด",
                 // --- คนที่ 2 (ถ้าพักเดี่ยว ปล่อยว่างหรือไม่มีก็ได้) ---
                "คำนำหน้า_2": "", "ชื่อ_2": "", "นามสกุล_2": "", "หน่วยงาน_2": ""
            },
            {
                "ลำดับ": 2,
                 // --- ข้อมูลส่วนกลาง ---
                "การพัก": "พักคู่",
                "โรงแรม": "Grand Richmond",
                "ห้องพัก": "B101",
                // --- คนที่ 1 ---
                "คำนำหน้า_1": "นาย",
                "ชื่อ_1": "สมชาย2",
                "นามสกุล_1": "ใจดี2",
                "หน่วยงาน_1": "สำนักยาฯ2",
                // --- คนที่ 2 (มีข้อมูล เพราะพักคู่) ---
                "คำนำหน้า_2": "นาย",
                "ชื่อ_2": "สมชาย3",
                "นามสกุล_2": "ใจดี3",
                "หน่วยงาน_2": "สำนักยาฯ3"
            },
            // ตัวอย่างเพิ่มเติม
            {
                "ลำดับ": 3,
                "การพัก": "พักคู่",
                "โรงแรม": "Grand Richmond",
                "ห้องพัก": "B102",
                "คำนำหน้า_1": "นางสาว", "ชื่อ_1": "มานี", "นามสกุล_1": "รักเรียน", "หน่วยงาน_1": "กรมวิทยาศาสตร์ฯ",
                "คำนำหน้า_2": "นางสาว", "ชื่อ_2": "ชูใจ", "นามสกุล_2": "ใฝ่รู้", "หน่วยงาน_2": "กรมควบคุมโรค"
            },
             {
                "ลำดับ": 4,
                "การพัก": "พักเดี่ยว",
                "โรงแรม": "Centara",
                "ห้องพัก": "Waitlist",
                "คำนำหน้า_1": "ดร.", "ชื่อ_1": "ปิติ", "นามสกุล_1": "มีทรัพย์", "หน่วยงาน_1": "กระทรวงสาธารณสุข",
                // ข้อมูลคนที่ 2 ไม่ใส่มาเลยก็ได้ ถ้าเป็นพักเดี่ยว
            }
        ];

        const tableBody = document.getElementById('tableBody');
        const searchInput = document.getElementById('searchInput');
        const noResultMsg = document.getElementById('noResult');
        const tableContainer = document.querySelector('.table-container');

        function renderTable(data) {
            tableBody.innerHTML = '';

            if (data.length === 0) {
                noResultMsg.style.display = 'block';
                tableContainer.style.display = 'none';
                return;
            } else {
                noResultMsg.style.display = 'none';
                tableContainer.style.display = 'block';
            }

            data.forEach(guest => {
                const row = document.createElement('tr');
                
                // เตรียมข้อมูลคนที่ 1
                const fullName1 = `${guest['คำนำหน้า_1'] || ''}${guest['ชื่อ_1'] || ''} ${guest['นามสกุล_1'] || ''}`;
                const dept1 = guest['หน่วยงาน_1'] || '-';

                // เตรียมข้อมูลคนที่ 2 (ตรวจสอบก่อนว่ามีข้อมูลหรือไม่)
                let fullName2 = "-";
                let dept2 = "-";
                // เช็คว่ามีชื่อคนที่ 2 หรือไม่ ถ้ามีให้แสดง
                if(guest['ชื่อ_2'] && guest['ชื่อ_2'].trim() !== "") {
                     fullName2 = `${guest['คำนำหน้า_2'] || ''}${guest['ชื่อ_2'] || ''} ${guest['นามสกุล_2'] || ''}`;
                     dept2 = guest['หน่วยงาน_2'] || '-';
                }

                // เตรียมข้อมูลที่พัก
                const roomType = guest['การพัก'] || '-';
                const hotel = guest['โรงแรม'] || '-';
                const roomNo = guest['ห้องพัก'] || '-';

                // สร้าง Badge ประเภทห้องพัก
                let roomTypeBadge = roomType;
                if(roomType === 'พักเดี่ยว') {
                    roomTypeBadge = `<span class="room-type-badge type-single">พักเดี่ยว</span>`;
                } else if (roomType.includes('คู่')) {
                    roomTypeBadge = `<span class="room-type-badge type-twin">${roomType}</span>`;
                }

                row.innerHTML = `
                    <td>${guest['ลำดับ']}</td>
                    <td><span class="fullname">${fullName1}</span></td>
                    <td>${dept1}</td>
                    <td class="roommate-cell"><span class="fullname">${fullName2}</span></td>
                    <td class="roommate-cell">${dept2}</td>
                    <td style="text-align:center;">${roomTypeBadge}</td>
                    <td>${hotel}</td>
                    <td style="text-align:center; font-weight:bold;">${roomNo}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // ฟังก์ชันค้นหา (หาจากข้อมูลทั้ง 2 คน และข้อมูลห้องพัก)
        function filterGuests(searchTerm) {
            const term = searchTerm.toLowerCase().trim();

            if (term === '') {
                renderTable(guestData);
                return;
            }

            const filteredData = guestData.filter(guest => {
                // รวมข้อมูลที่ต้องการค้นหาทั้งหมดมาต่อกันเป็น string เดียว
                const searchableString = `
                    ${guest['ชื่อ_1'] || ''} ${guest['นามสกุล_1'] || ''} ${guest['หน่วยงาน_1'] || ''}
                    ${guest['ชื่อ_2'] || ''} ${guest['นามสกุล_2'] || ''} ${guest['หน่วยงาน_2'] || ''}
                    ${guest['โรงแรม'] || ''} ${guest['ห้องพัก'] || ''}
                `.toLowerCase();
                
                // ตรวจสอบว่าคำค้นหามีอยู่ใน string รวมหรือไม่
                return searchableString.includes(term);
            });

            renderTable(filteredData);
        }

        searchInput.addEventListener('keyup', (e) => {
            filterGuests(e.target.value);
        });

        // เริ่มต้นแสดงข้อมูล
        renderTable(guestData);

    </script>
</body>
</html>
